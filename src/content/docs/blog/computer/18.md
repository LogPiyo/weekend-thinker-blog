---
title: 'CloudflareのBulk Redirects（一括リダイレクト）の使い方'
description: 'CloudflareのBulk Redirects（一括リダイレクト）機能を使い、CSVファイルを用いて複数のURLを一括でリダイレクト設定する手順やCSVの書き方、各項目の意味について解説します。'
pubDate: '2025/08/15'
heroImage: ''
tags: ['プログラミング']
sidebar:
  badge: 'Cloudflare'
---

Cloudflare Workersでリダイレクトをする方法として，Single RedirectsとBulk Redirectsの2つがある。Single Redirectsは1つのURLを別のURLにリダイレクトするのに対し、Bulk Redirectsは複数のURLを一括でリダイレクトすることができる。大量のURLをリダイレクトする場合は、Bulk Redirectsを使用するとよい。無料版でも10000件までURLを登録できる。ただし，2025年8月現在，一部のアカウントで，最大登録数が20件に制限される場合があることに注意してほしい。これは，移行期間中の暫定措置だと思われる。

## 手順1: CSVファイルを用意する
```plaintext
<SOURCE_URL>,<TARGET_URL>[,<STATUS_CODE>,<PRESERVE_QUERY_STRING>,<INCLUDE_SUBDOMAINS>,<SUBPATH_MATCHING>,<PRESERVE_PATH_SUFFIX>]
```
という形式のCSVファイルを用意する。例えば，
```csv filename="redirects.csv"
example.com/contacts,https://example.net/contact-us,301,,,,
example.com/about,https://example.net/about-us,,FALSE,TRUE,,
example.com/docs,https://example.com/draft-docs,302,,TRUE
```
というように書く。

### 各フィールドの説明

- `SOURCE_URL`
  - リダイレクト元のURLを指定する
  - URLスキームは省略可能である
    - 省略した場合は`https`と`http`の両方に適用される
  - 必須項目
- `TARGET_URL`
  - リダイレクト先のURLを指定する
  - 必須項目
- `STATUS_CODE`
  - リダイレクトのステータスコードを指定する
  - 301, 302, 307, 308 のいずれかを指定する
  - 省略した場合はデフォルトで 301 が使用される
- `PRESERVE_QUERY_STRING`
    - クエリ文字列を保持するか選択する
    - `TRUE` または `FALSE` を指定する
    - 省略した場合はデフォルトで `FALSE` である
- `INCLUDE_SUBDOMAINS`
    - サブドメインにも適用するか選択する
    - `TRUE` または `FALSE` を指定する
    - 省略した場合はデフォルトで `FALSE` である
- `SUBPATH_MATCHING`
    - サブパスのマッチングを行うか選択する
    - `TRUE`のときは，`/my-folder/` が `/other-folder/` へリダイレクトされるとき，`/my^folder/foo/`も`/other-folder`へリダイレクトされる
    - `TRUE` または `FALSE` を指定する
    - 省略した場合はデフォルトで `FALSE` である
- `PRESERVE_PATH_SUFFIX`
    - パスのサフィックスを保持するか選択する
    - `TRUE`のときは，`/my-folder/` が `/other-folder/` へリダイレクトされるとき，`/my^folder/foo/`は`/other-folder/foo/`へリダイレクトされる
    - `TRUE` または `FALSE` を指定する
    - 省略した場合はデフォルトで `FALSE` である

### 備考
- CSVファイルには、列名を示すヘッダー行を含めてはならない
- ソースURLやターゲットURLにカンマ（,）が含まれる場合は、引用符（"）で囲む
- オプションの値は、値を入力せずにすぐカンマ（区切り文字）を入力することで省略できる
- 末尾のカンマを含める必要はない

## 手順2: Cloudflareでデプロイする
1. アカウント ホームにアクセスし，サイドバーから Bulk redirects を選択する
2. 「一括リダイレクトの作成」をクリックする
3. 指示に従い，CSVファイルをアップロードする
4. 「保存してデプロイ」をクリックした完了

## 参考文献
- [公式ドキュメント](https://developers.cloudflare.com/rules/url-forwarding/bulk-redirects/)